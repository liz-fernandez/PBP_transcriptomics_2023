<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="generator" content="pandoc">
    <title>BI-Transcriptomics: Análisis transcriptómicos</title>
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="css/bootstrap/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="css/bootstrap/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="css/swc.css" />
    <link rel="alternate" type="application/rss+xml" title="PBI - Transcriptomica" href="http://bi.ira.cinvestav.mx:8282/"/>
    <meta charset="UTF-8" />
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body class="lesson">
    <div class="container card">
      <div class="banner">
        <a href="http://bp.ira.cinvestav.mx/" title="Posgrado en Biotecnologia de
            Plantas">
          <img alt="Logo PBP" src="img/posgrado_pbp_logo.jpg" />
        </a>
      </div>
      <article>
      <div class="row">
        <div class="col-md-10 col-md-offset-1">
                    <a href="index.html"><h1 class="title">Análisis transcriptómicos</h1></a>
          <h2 class="subtitle">Exploradores de genomas y transcriptomas</h2>
          <section class="objectives panel panel-warning">
<div class="panel-heading">
<h2 id="objetivos-de-aprendizaje"><span class="glyphicon glyphicon-certificate"></span>Objetivos de aprendizaje</h2>
</div>
<div class="panel-body">
<ul>
<li>Entender que datos se muestran en un explorador de genomas</li>
<li>Aprender a explorar datos</li>
</ul>
</div>
</section>
<section class="prereq panel panel-warning">
<div class="panel-heading">
<h2 id="datos-requeridos"><span class="glyphicon glyphicon-education"></span>Datos requeridos</h2>
</div>
<div class="panel-body">
<p>Para proceder con esta práctica, se requieren los resultados de la clase de mapeo:</p>
<ul>
<li>Archivos de mapeo generados del transcriptoma via GMAP and Tophat2</li>
</ul>
</div>
</section>
<h1 id="introducción-al-navegador-de-genomas-ucsc">Introducción al navegador de genomas UCSC</h1>
<p>Uno de los navegadores de genomas más utilizados el de UCSC. Tiene varias copias (mirrors) alrededor del mundo y alta funcionalidad.</p>
<p>Este navegador es útil cuando tenemos acceso al <strong>genoma del organismo de interés</strong>.</p>
<p>Abramos el navegador de genomas.</p>
<p><a href="http://genome.ucsc.edu" class="uri">http://genome.ucsc.edu</a></p>
<p>Da click en el link en la esquina superior izquierda que dice <code>Genomes</code>:</p>
<div class="figure">
<img src="fig/01_Welcomepage.jpg" alt="Página de entrada" />
<p class="caption">Página de entrada</p>
</div>
<p>Deberían ver una página similar a esta:</p>
<div class="figure">
<img src="fig/02_WelcomeBrowserPage.jpg" alt="Página de entrada browser" />
<p class="caption">Página de entrada browser</p>
</div>
<p>La mayoría de los genomas de organismos modelos están disponibles en el navegador de genomas de UCSC. Sin embargo hay muchos que no lo están. Para ver que genomas están disponibles pueden revisar el menú desplegable debajo del título <code>genome</code>.</p>
<p>Naveguemos al gen <em>Homo sapiens breast cancer 1</em> o <em>BRCA1</em>. Mutaciones en este gen se le ha involucrado con riesgo de padecer cáncer de mama.</p>
<p>Selecciona en el menú desplegable debajo de <code>genome</code> la versión del genoma humano <code>Dec. 2013 (GRCh38/hg38)</code>. Escribe en el campo llamado <code>search term</code> BRCA1, aparecerá en la parte de abajo un menú en el cuál puedes seleccionar este gen. Selecciónalo y da click en <code>Submit</code> para desplegarlo en el navegador.</p>
<div class="figure">
<img src="fig/03_GenomeBrowser_entry.jpg" alt="Navegando al gen BRCA1" />
<p class="caption">Navegando al gen BRCA1</p>
</div>
<p>El navegador despliega distintos tipos de información. Debajo del título que indica que versión del genoma humano estamos navegando vemos botones que nos permiten movernos a la derecha o la izquierda en el genoma, así como acercarnos o alejarnos de una región con distintas escalas.</p>
<div class="figure">
<img src="fig/04_BrowserStart.jpg" alt="Navegador de genomas - humano" />
<p class="caption">Navegador de genomas - humano</p>
</div>
<p>Después de estos botones encontramos coordenadas que nos indican en que parte del genoma nos encontramos. También tenemos un campo de búsqueda que nos permite buscar genes por nombre, indicar coordenadas así como buscar información de los datos (tracks) depositados en el navegador.</p>
<p>Debajo de este encontramos un mapa del cromosoma 17 (chr17) que es donde se ubica este gen. El mapa despliega una barra roja que indica la región en la que nos encontramos, para así ubicarnos en relación al resto del genoma.</p>
<p>Finalmente, un recuadro gráfico muestra distintos tipos de datos que se encuentran asociados a esta región del genoma humano. En la parte superior encontramos una barra de escala que nos da una idea que tan grande o pequeña es la región que observamos, también tenemos indicadores de la posición en el cromosoma. Debajo de esta se encuentran los datos depositados en este genoma. Estos datos se presentan en grupos llamados <code>tracks</code>. Cada uno de estos <code>tracks</code> tiene un título asociado. En el lado izquierdo de cada track hay un botón gris que nos permite ajustar con que tanto detalle se presentan los datos en cada track.</p>
<p>Antes de proseguir vamos a alejarnos de esta región dando click al botón <code>3x</code> a la derecha de <code>zoom out</code>. Esto nos permitira ver no solo el gen BRCA1 sino también sus regiones aledañas.</p>
<div class="figure">
<img src="fig/05_BrowserZoomedOut.jpg" alt="Navegador alejado" />
<p class="caption">Navegador alejado</p>
</div>
<p>Los primeros dos tracks nos muestran anotaciones de genes de acuerdo <strong>GENCODE</strong> (1) y a <strong>RefSeq</strong> (2). En estos tracks los bloques indican exones, mientras que las líneas delgadas indican intrones. La dirección de transcripción del gen se muestra como pequeñas flechas dentro de los intrones apuntando hacia la derecha o la izquierda.</p>
<p>Debajo de estos vemos otro <code>track</code> llamado <strong>OMIM Allelic Variant SNPs</strong>, este tiene líneas verdes, cada una de las cuales indica un SNP (single nucleotide polymorphism). Debajo de esta hay otro track llamado <strong>Human mRNAs</strong>. Ocupa solo una línea y no es muy claro donde empieza y donde termina cada transcrito. Demos click en el botón gris del lado izquierdo de este track:</p>
<div class="figure">
<img src="fig/07_DensityHumanmRNAs.jpg" alt="TrackHubs" />
<p class="caption">TrackHubs</p>
</div>
<p>Hagamos click en el menú junto a <code>display mode</code> y seleccionemos <code>squish</code>, una vez seleccionado demos click en <code>Submit</code>. El resultado es el siguiente:</p>
<div class="figure">
<img src="fig/08_DensityHumanmRNAs-Squish.jpg" alt="TrackHubs" />
<p class="caption">TrackHubs</p>
</div>
<p>Finalmente, podemos reordenar los tracks haciendo click en su parte izquierda. Cuando el <code>track</code> se resalta en color verde podemos subirlo o bajarlo con respecto a otros tracks para cambiar el orden de despliegue.</p>
<p>A pesar de que no podemos ver las estructuras a detalle nos damos una mejor idea de donde hay un transcrito o no.</p>
<h1 id="añadiendo-datos-nuevos-al-navegador-de-genomas-ucsc">Añadiendo datos nuevos al navegador de genomas UCSC</h1>
<p>Como les mencione, hay varios genomas que no están en el navegador de UCSC. Esto incluye al organismo de nuestro estudio <em>Saccharomyces pombe</em>.</p>
<p>Existe una forma de añadir otros genomas de manera temporal al navegador llamado un hub de ensamble (<code>Assembly hub</code>). Para esto, necesitamos crear una carpeta accesible en línea desde nuestra computadora para que podamos subir los datos al navegador.</p>
<p>Volvamos al directorio base de nuestro usuario y creemos un directorio llamado <code>public_html</code>:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">cd</span>
$ <span class="kw">mkdir</span> public_html 
$ <span class="kw">cd</span> public_html</code></pre></div>
<p>En este directorio vamos a generar nuestro assembly hub.</p>
<p>Tiene que tener la siguiente estructura:</p>
<pre class="output"><code>myHub/ - Directorio para organizar los archivos del hub
     hub.txt – Archivo de texto plano para definir el hub:
     genomes.txt – Definiciones de cada genoma en este hub
          newOrg1/ - Directorio de archivos para un genoma particular
               newOrg1.2bit – Archivo en formato ‘2bit’ construido a partir de la secuencia fasta
               description.html – información acerca de este ensamble para otros usuarios
               trackDb.txt – definiciones de tracks en este ensamble
               groups.txt – definiciones de grupos de tracks en este ensamble
               bam, bigWig and bigBed files – data para tracks en este ensamble</code></pre>
<p>Creemos primero los archivos base:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">mkdir</span> GenomeHub
$ <span class="kw">cd</span> GenomeHub 
$ <span class="kw">gedit</span> hub.txt</code></pre></div>
<p>En este archivo <code>hub.txt</code> escribiremos lo siguiente (sustituyan NOMBRE por su nombre):</p>
<pre class="output"><code>hub Sp_genome_hub
shortLabel Saccharomyces pombe Genome (NOMBRE)
longLabel Saccharomyces pombe Genome and tracks setup by NOMBRE
genomesFile genomes.txt
email myemail@mysite.com
descriptionURL aboutHub.html</code></pre>
<p>Y en el archivo <code>genomes.txt</code> escribiremos lo siguiente:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">gedit</span> genomes.txt</code></pre></div>
<pre class="output"><code>genome sacPom1
trackDb sacPom1/trackDb.txt
groups sacPom1/groups.txt
description Saccharomyces pombe Genome
twoBitPath sacPom1/sacPom1.2bit
organism Saccharomyces pombe
#defaultPos EQ973772:1000000-2000000
scientificName Saccharomyces pombe
htmlPath sacPom1/description.html</code></pre>
<h3 id="generando-archivos">Generando archivos</h3>
<p>Para generar los archivos necesarios para nuestro hub debemos descargar los siguientes programas:</p>
<ul>
<li><a href="http://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/faToTwoBit">faToTwoBit</a></li>
<li><a href="http://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/twoBitInfo">twoBitInfo</a></li>
</ul>
<p>Y vamos a descargar a copiar el genoma al que mapeamos a este directorio. Si no lo tienen lo pueden descargar de aquí <a href="datasets/genome/Sp_genome.fa">Sp_genome.fa</a>.</p>
<p>Generamos la referencia y la movemos al directorio <code>sacPom1</code>:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">chmod</span> 755 faToTwoBit twoBitInfo
$ <span class="kw">./faToTwoBit</span> Sp_genome.fa sacPom1.2bit
$ <span class="kw">mkdir</span> sacPom1
$ <span class="kw">mv</span> sacPom1.2bit sacPom1/</code></pre></div>
<p>Generamos la información acerca del tamaño de los cromosomas:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">./twoBitInfo</span> ./sacPom1/sacPom1.2bit stdout <span class="kw">|</span> <span class="kw">sort</span> -k2rn <span class="kw">&gt;</span> sacPom1.chrom.sizes</code></pre></div>
<p>Una vez generados nuestros archivos entramos al directorio sacPom1. Movemos ahí los archivos generados en la clase de mapeo.</p>
<ul>
<li>trinity_gmap.bam</li>
<li>trinity_gmap.bai</li>
<li>accepted_hits.bam</li>
</ul>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">cd</span> sacPom1
$ <span class="kw">mv</span> trinity_gmap.bam trinity_gmap.bai accepted_hits.bam .</code></pre></div>
<p>Finalmente vamos a hacer un índice para los hits de tophat</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">samtools</span> sort accepted_hits.bam accepted_hits_sorted
$ <span class="kw">samtools</span> index accepted_hits_sorted.bam</code></pre></div>
<p>Generaremos un archivo llamado groups.txt</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">gedit</span> groups.txt</code></pre></div>
<p>Y agregaremos el siguiente contenido:</p>
<pre class="output"><code>name map
label Mapping
priority 2
defaultIsClosed 0</code></pre>
<p>Crearemos un archivo llamado <code>trackDb.txt</code>. Este es uno de los archivo más importantes ya que especifica como se muestran los tracks.</p>
<p>Agreguemos nuestro primeros tracks con los resultados de TopHat2 y GMAP</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">gedit</span> trackDb.txt</code></pre></div>
<pre class="output"><code>#database: sacPom1 - esto es un comentario

track TopHat2_Mapping_Reads
bigDataUrl http://**&lt;IP&gt;**/~usuario/GenomeHub/sacPom1/accepted_hits_sorted.bam
shortLabel TopHat2_Mapping
longLabel Paired end reads Sp exp mapped with TopHat2
pairEndsByName on
showNames on
bamColorMode strand
#bamGrayMode unpaired
baseColorDefault diffBases
baseColorUseSequence lfExtra
type bam
#noColorTag .
#aliQualRange 0:60
indelDoubleInsert on
indelQueryInsert on
pairSearchRange 5000
#showDiffBasesAllScales .
showDiffBasesMaxZoom 100
maxWindowToDraw 1000000
visibility hide
showNames off

track transcriptome_GMAP
bigDataUrl http://**&lt;IP&gt;**/~usuario/GenomeHub/sacPom1/trinity_gmap.bam
shortLabel transcriptome_GMAP
longLabel Trinity transcriptome mapped with GMAP
pairEndsByName off
showNames on
bamColorMode strand
#bamGrayMode unpaired
baseColorDefault diffBases
baseColorUseSequence lfExtra
type bam
#noColorTag .
#aliQualRange 0:60
indelDoubleInsert on
indelQueryInsert on
pairSearchRange 5000
#showDiffBasesAllScales .
showDiffBasesMaxZoom 100
maxWindowToDraw 1000000
visibility hide
showNames off</code></pre>
<p>Las especificaciones de otros tipos de tracks se pueden consultar en este <a href="https://genome.ucsc.edu/goldenpath/help/trackDb/trackDbHub.html">link</a>.</p>
<p>Activamos nuestro directorio para que pueda ser visto desde la red:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">sudo</span> service apache2 start
<span class="kw">sudo</span> a2enmod userdir.conf
<span class="kw">sudo</span> service apache2 reload
<span class="kw">chmod</span> -R 755 ~/public_html</code></pre></div>
<p>Para verificar que funciona navegaremos a nuestro IP. Averiguamos nuestro IP con el comando:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">ip</span> a <span class="kw">|</span> <span class="kw">grep</span> inet <span class="kw">|</span> <span class="kw">grep</span> eth1</code></pre></div>
<p>Nuestra IP es el primer número después de inet. No podemos accesar a estas computadoras pero veamos un ejemplo en otro servidor:</p>
<p><a href="http://203.101.225.191/~selene/GenomeHub/hub.txt" class="uri">http://203.101.225.191/~selene/GenomeHub/hub.txt</a></p>
<p>Pongan su IP en vez de la del ejemplo:</p>
<p>Finalmente abrimos el navegador de genomas y damos click en la parte de abajo de la ventana de navegación en el botón <code>track hubs</code>. Esto nos lleva a la página siguiente:</p>
<div class="figure">
<img src="fig/06_TrackHubs.jpg" alt="TrackHubs" />
<p class="caption">TrackHubs</p>
</div>
<p>Pegamos nuestra dirección y damos click en <code>Add Hub</code>.</p>
<div class="figure">
<img src="fig/09_AddingHub.jpg" alt="TrackHubs" />
<p class="caption">TrackHubs</p>
</div>
<p>Si todo salió bien nos redirigira a nuestro hub.</p>
        </div>
      </div>
      </article>
      <div class="footer">
        <a class="label swc-blue-bg" href="mailto:selene.fernandez.valverde@gmail.com">Contacto</a>
        <a class="label swc-blue-bg" href="LICENSE.html">Licencia</a>
      </div>
    </div>
    <!-- Javascript placed at the end of the document so the pages load faster -->
    <script src="http://software-carpentry.org/v5/js/jquery-1.9.1.min.js"></script>
    <script src="css/bootstrap/bootstrap-js/bootstrap.js"></script>
    <script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>
  </body>
</html>
